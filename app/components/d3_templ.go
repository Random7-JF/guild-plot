// Code generated by templ - DO NOT EDIT.

// templ: version: v0.3.960
package components

//lint:file-ignore SA4006 This context is only used if a nested component is present.

import "github.com/a-h/templ"
import templruntime "github.com/a-h/templ/runtime"

func Test() templ.Component {
	return templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
		templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
		if templ_7745c5c3_CtxErr := ctx.Err(); templ_7745c5c3_CtxErr != nil {
			return templ_7745c5c3_CtxErr
		}
		templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
		if !templ_7745c5c3_IsBuffer {
			defer func() {
				templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
				if templ_7745c5c3_Err == nil {
					templ_7745c5c3_Err = templ_7745c5c3_BufErr
				}
			}()
		}
		ctx = templ.InitializeContext(ctx)
		templ_7745c5c3_Var1 := templ.GetChildren(ctx)
		if templ_7745c5c3_Var1 == nil {
			templ_7745c5c3_Var1 = templ.NopComponent
		}
		ctx = templ.ClearChildren(ctx)
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 1, "<!doctype html><html lang=\"en\"><head><meta charset=\"UTF-8\"><meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"><title>D3 Static Map with Markers & Tooltips</title><script src=\"https://d3js.org/d3.v7.min.js\"></script><style>\n        body {\n            font-family: sans-serif;\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            justify-content: center;\n            min-height: 100vh;\n            margin: 0;\n            background-color: #f0f0f0;\n        }\n        h1 { margin-bottom: 20px; }\n\n        .map-container {\n            width: 90%; /* Responsive width */\n            max-width: 900px; /* Max width of your map */\n            height: auto; /* Maintain aspect ratio */\n            border: 1px solid #ccc;\n            box-shadow: 0 4px 8px rgba(0,0,0,0.1);\n            position: relative; /* Needed for absolute tooltip positioning */\n            background-color: #fff;\n        }\n\n        .map-container svg {\n            display: block; /* Remove extra space below SVG */\n            width: 100%;\n            height: 100%;\n            overflow: visible; /* Important for tooltips to extend beyond SVG bounds */\n        }\n\n        /* Styles for the map markers */\n        .marker-circle {\n            fill: #e74c3c; /* Red color */\n            stroke: #c0392b; /* Darker red border */\n            stroke-width: 2px;\n            cursor: pointer;\n            transition: fill 0.2s ease-in-out;\n            pointer-events: all; /* Ensure the circle receives events */\n        }\n        .marker-circle:hover {\n            fill: #c0392b; /* Darken on hover */\n        }\n\n        .marker-text {\n            fill: white; /* Text color */\n            font-family: sans-serif;\n            font-size: 14px; /* Text size */\n            text-anchor: middle; /* Center text horizontally */\n            pointer-events: none; /* Text should not block clicks on the circle */\n            text-shadow: 1px 1px 2px rgba(0,0,0,0.5); /* For better readability */\n        }\n\n        /* Tooltip styles */\n        #tooltip {\n            position: absolute;\n            background-color: rgba(0, 0, 0, 0.85);\n            color: white;\n            padding: 8px 12px;\n            border-radius: 4px;\n            font-size: 14px;\n            pointer-events: none; /* Tooltip itself should not block interaction */\n            opacity: 0;\n            transition: opacity 0.2s ease-in-out;\n            white-space: nowrap; /* Prevent text wrapping */\n            z-index: 1000;\n        }\n        #tooltip.visible {\n            opacity: 1;\n        }\n    </style></head><body><h1>Interactive Map with D3.js (API Data)</h1><div class=\"map-container\" id=\"mapContainer\"><svg id=\"mapSvg\" viewBox=\"0 0 3840 2560\" preserveAspectRatio=\"xMidYMid meet\"><image href=\"/static/img/map.jpg\" x=\"0\" y=\"0\" width=\"3840\" height=\"2560\"></image> <g class=\"markers-group\"></g></svg><div id=\"loading-indicator\">Loading marker data...</div></div><div id=\"tooltip\"></div><script>\n\t\n        // Select the SVG element and the markers group\n        const svg = d3.select(\"#mapSvg\");\n        const markersGroup = svg.select(\".markers-group\");\n        const htmlTooltip = d3.select(\"#tooltip\");\n        const mapContainer = document.getElementById('mapContainer'); // Get the raw DOM element\n        const loadingIndicator = document.getElementById('loading-indicator')\n\n        // Function to render/update markers based on fetched data\n        function renderMarkers(markerData) {\n            const markers = markersGroup.selectAll(\".marker\")\n                .data(markerData, d => d.PlotNumber); // Use d.id for object constancy\n\n            // EXIT selection: Remove old markers\n            markers.exit().remove();\n\n            // ENTER selection: Create new marker groups for new data points\n            const newMarkers = markers.enter()\n                .append(\"g\")\n                .attr(\"class\", \"marker\");\n\n            // Append a circle to each new marker group\n            newMarkers.append(\"circle\")\n                .attr(\"class\", \"marker-circle\")\n                .attr(\"r\", 15);\n\n            // Append text to each new marker group\n            newMarkers.append(\"text\")\n                .attr(\"class\", \"marker-text\")\n                .attr(\"dy\", \"0.35em\")\n                .text(d => d.name);\n\n            // UPDATE selection (and ENTER): Position the markers and add events\n            markers.merge(newMarkers)\n                .attr(\"transform\", d => `translate(${d.X}, ${d.Y})`)\n\n                // Add event listeners for hover (tooltip)\n                .on(\"mouseenter\", function(event, d) {\n                    htmlTooltip.text(`${d.Owner} - Occupied: ${d.Occupied || 'N/A'}`);\n                    htmlTooltip.classed(\"visible\", true);\n\n                    const markerRect = this.getBoundingClientRect();\n                    const mapContainerRect = mapContainer.getBoundingClientRect();\n\n                    const tooltipX = markerRect.left + markerRect.width / 2 - mapContainerRect.left;\n                    const tooltipY = markerRect.top - mapContainerRect.top;\n\n                    htmlTooltip.style(\"left\", `${tooltipX}px`);\n                    htmlTooltip.style(\"top\", `${tooltipY - 10}px`);\n                    htmlTooltip.style(\"transform\", \"translate(-50%, -100%)\");\n                })\n                .on(\"mouseleave\", () => {\n                    htmlTooltip.classed(\"visible\", false);\n                })\n\n                // Add click event listener\n                .on(\"click\", function(event, d) {\n                    alert(`You clicked on: ${d.Owner}\\nCoordinates: (${d.X}, ${d.Y})`);\n                    // You could fetch more detailed info for this specific marker here\n                });\n        }\n\n        // --- Data Fetching Logic ---\n        async function fetchMarkerData() {\n            loadingIndicator.style.display = 'block'; // Show loading indicator\n            try {\n                // Simulate network delay (remove in production)\n                await new Promise(resolve => setTimeout(resolve, 1000));\n\n                const response = await fetch(\"/api/v1/plots\"); // Your actual API endpoint\n                if (!response.ok) {\n                    throw new Error(`HTTP error! Status: ${response.status}`);\n                }\n                const data = await response.json();\n\n                // Assuming your API returns an array of objects like this:\n                // [{ id: 'loc1', x: 200, y: 150, name: 'Main City', additionalInfo: 'Pop. 10k' }, ...]\n                // Ensure your data keys match 'id', 'x', 'y', 'name', etc.\n                renderMarkers(data);\n\n            } catch (error) {\n                console.error(\"Error fetching marker data:\", error);\n                // Display an error message to the user if needed\n                alert(\"Failed to load map data. Please try again later.\");\n            } finally {\n                loadingIndicator.style.display = 'none'; // Hide loading indicator\n            }\n        }\n\t\tfetchMarkerData()\n    </script></body></html>")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		return nil
	})
}

var _ = templruntime.GeneratedTemplate
